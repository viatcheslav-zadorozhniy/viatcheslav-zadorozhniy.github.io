{"version":3,"file":"488.8c9c6c87d5e93aab.js","mappings":"qPAUMA,iBACEA,iBAOAA,kBAAwCA,SAAcA,+CANpDA,2CAA0B,cAA1BA,CAA0B,mBAA1BA,CAA0B,mBAMYA,+CAT5CA,iBACEA,uBAUFA,kCAVyBA,kDAYzBA,0DApBJA,yCAIEA,0DAAUA,6BAAoB,GAE9BA,iBACEA,uBAaAA,uBACFA,kCAlBAA,6BAIiCA,iDAazBA,sCCjBV,MAAMC,EAAiB,CACrB,CACEC,KAAM,GACNC,UCOJ,MAAM,MAAOC,UAAyBC,IAcpCC,YACEC,EACAC,EACiBC,GAEjBC,MAAMH,EAAMC,GAFKG,kBAfnBA,kBAA+B,GAEtBA,YAAS,GACTA,aAAU,IACVA,cAAWA,KAAKC,QAAUD,KAAKE,OAE/BF,cAAW,GACXA,oBAAiC,EAAhBA,KAAKG,SACtBH,iBAAc,8CAEfA,eAAY,CAQnB,CAEQI,WACP,MAAMC,EAAsBC,KAAKC,MAAMP,KAAKF,WAAWU,cAAcC,aAAeT,KAAKG,UAEzFH,KAAKU,UAAYV,KAAKW,gBACtBX,KAAKY,SAAWZ,KAAKU,WAAmC,EAAtBL,GAElCN,MAAMK,UACP,CAEkBS,kBAAkBC,GACnC,IAAIC,EAAwBf,KAAKgB,aAAahB,KAAKgB,aAAaC,OAAS,IAAM,GAE1EjB,KAAKgB,aAAaC,OAEZF,EAAaE,SAAWjB,KAAKU,YACtCK,EAAe,GACff,KAAKgB,aAAaE,KAAKH,IAHvBf,KAAKgB,aAAaE,KAAKH,GAMzBD,EAAOK,QAAQC,IACbL,EAAaG,KAAKE,GAEdL,EAAaE,SAAWjB,KAAKU,YAC/BK,EAAe,GACff,KAAKgB,aAAaE,KAAKH,GAAvB,GAIJf,KAAKgB,aAAe,IAAIhB,KAAKgB,aAC9B,CAEOL,gBAGN,OAAOL,KAAKC,OAFWP,KAAKF,WAAWU,cAAca,YAAcrB,KAAKE,QAEpCF,KAAKG,SAC1C,+CAzDUV,GAAgBJ,gEAAhBI,EAAgB6B,2oBFf7BjC,gBAAkCA,mBAAOA,QAEzCA,uMEaaI,CAAb,ODCO,IAAM8B,EAAb,MAAM,MAAOA,kDAAoB,0BAApBA,gCAHDC,cAAsBlC,GACtBkC,QAECD,CAAb,KEIaE,EAAb,MAAM,MAAOA,kDAAa,0BAAbA,gCARTC,KACAC,KACAC,IACAL,EACAM,QAISJ,CAAb","names":["i0","routes","path","component","GalleryComponent","InfiniteScrollComponent","constructor","http","cdr","elementRef","super","this","imgSize","rowGap","itemSize","ngOnInit","maxItemsPerViewport","Math","floor","nativeElement","offsetHeight","groupSize","calcGroupSize","pageSize","onAfterItemsAdded","photos","currentGroup","groupedItems","length","push","forEach","photo","offsetWidth","selectors","GalleryRoutingModule","RouterModule","GalleryModule","CommonModule","ScrollingModule","PlatformShieldModule","NgxSkeletonLoaderModule"],"sourceRoot":"webpack:///","sources":["./libs/demo/src/lib/gallery/gallery.component.html","./libs/demo/src/lib/gallery/gallery-routing.module.ts","./libs/demo/src/lib/gallery/gallery.component.ts","./libs/demo/src/lib/gallery/gallery.module.ts"],"sourcesContent":["<h1 class=\"pt-3 px-3 text-center\">Gallery</h1>\n\n<cdk-virtual-scroll-viewport\n  *browserRender\n  class=\"block-100\"\n  [itemSize]=\"itemSize\"\n  (scroll)=\"scrollStream$.next()\"\n>\n  <div class=\"d-flex flex-column mx-auto pb-3\">\n    <div *cdkVirtualFor=\"let group of groupedItems\" class=\"d-flex column-gap-3 pt-3 mx-auto\">\n      <div *ngFor=\"let photo of group\" class=\"position-relative\">\n        <img\n          [src]=\"photo.thumbnailUrl\"\n          [alt]=\"photo.title\"\n          [height]=\"imgSize\"\n          [width]=\"imgSize\"\n          class=\"d-block\"\n        >\n        <div class=\"position-absolute photo-id\">{{ photo.id }}</div>\n      </div>\n    </div>\n\n    <div *ngIf=\"canLoadMore\" class=\"loader\"></div>\n  </div>\n</cdk-virtual-scroll-viewport>\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\n\nimport { GalleryComponent } from './gallery.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: GalleryComponent,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class GalleryRoutingModule { }\n","import { HttpClient } from '@angular/common/http';\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, OnInit } from '@angular/core';\n\nimport { Photo } from '@playground/domain';\nimport { InfiniteScrollComponent } from '@playground/shared';\n\n@Component({\n  selector: 'playground-gallery',\n  templateUrl: './gallery.component.html',\n  styleUrls: ['./gallery.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  host: {\n    class: 'full-size d-flex flex-column'\n  }\n})\nexport class GalleryComponent extends InfiniteScrollComponent<Photo> implements OnInit {\n\n  groupedItems: Array<Photo[]> = [];\n\n  readonly rowGap = 16;\n  readonly imgSize = 150;\n  readonly itemSize = this.imgSize + this.rowGap;\n\n  override pageSize = 32;\n  override loadMoreMargin = this.itemSize * 2;\n  override resourceUrl = 'https://jsonplaceholder.typicode.com/photos';\n\n  private groupSize = 8;\n\n  constructor(\n    http: HttpClient,\n    cdr: ChangeDetectorRef,\n    private readonly elementRef: ElementRef<HTMLElement>,\n  ) {\n    super(http, cdr);\n  }\n\n  override ngOnInit(): void {\n    const maxItemsPerViewport = Math.floor(this.elementRef.nativeElement.offsetHeight / this.itemSize);\n\n    this.groupSize = this.calcGroupSize();\n    this.pageSize = this.groupSize * (maxItemsPerViewport * 2);\n\n    super.ngOnInit();\n  }\n\n  protected override onAfterItemsAdded(photos: Photo[]): void {\n    let currentGroup: Photo[] = this.groupedItems[this.groupedItems.length - 1] || [];\n\n    if (!this.groupedItems.length) {\n      this.groupedItems.push(currentGroup);\n    } else if (currentGroup.length === this.groupSize) {\n      currentGroup = [];\n      this.groupedItems.push(currentGroup);\n    }\n\n    photos.forEach(photo => {\n      currentGroup.push(photo);\n\n      if (currentGroup.length === this.groupSize) {\n        currentGroup = [];\n        this.groupedItems.push(currentGroup);\n      }\n    });\n\n    this.groupedItems = [...this.groupedItems];\n  }\n\n  private calcGroupSize(): number {\n    const availableWidth = this.elementRef.nativeElement.offsetWidth - this.rowGap;\n\n    return Math.floor(availableWidth / (this.itemSize));\n  }\n\n}\n","import { ScrollingModule } from '@angular/cdk/scrolling';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { NgxSkeletonLoaderModule } from 'ngx-skeleton-loader';\n\nimport { PlatformShieldModule } from '@playground/shared';\n\nimport { GalleryRoutingModule } from './gallery-routing.module';\nimport { GalleryComponent } from './gallery.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    ScrollingModule,\n    PlatformShieldModule,\n    GalleryRoutingModule,\n    NgxSkeletonLoaderModule,\n  ],\n  declarations: [GalleryComponent],\n})\nexport class GalleryModule {}\n"],"x_google_ignoreList":[]}