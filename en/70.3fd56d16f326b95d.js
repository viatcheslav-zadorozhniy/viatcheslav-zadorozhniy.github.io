"use strict";(self.webpackChunki18n=self.webpackChunki18n||[]).push([[70],{8070:(I,d,r)=>{r.r(d),r.d(d,{RtcModule:()=>P});var l=r(4666),u=r(4522),p=r(2965),m=r(3918),t=r(2560),f=r(7157);const h=["localVideo"],g=["remoteVideo"];function C(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.togglePictureInPicture())}),t._uU(1,"Toggle Picture-in-Picture"),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",!e.rtcActive)}}function R(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",3)(2,"button",4),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.startRTC())}),t._uU(3,"Start RTC"),t.qZA(),t.TgZ(4,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.stopRTC())}),t._uU(5,"Stop RTC"),t.qZA()(),t.TgZ(6,"section",6)(7,"h3"),t._uU(8,"Local video"),t.qZA(),t._UZ(9,"video",7,8),t.TgZ(11,"div",9),t.YNc(12,C,2,1,"button",10),t.qZA()(),t.TgZ(13,"section")(14,"h3"),t._uU(15,"Remote video"),t.qZA(),t._UZ(16,"video",7,11),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(),c=t.MAs(4);t.xp6(2),t.Q6J("disabled",e.rtcActive),t.xp6(2),t.Q6J("disabled",!e.rtcActive),t.xp6(8),t.Q6J("ngIf",e.pictureInPictureEnabled)("ngIfElse",c)}}function v(n,o){1&n&&t._uU(0," Your device does not support real-time communication in the Web.\n")}function _(n,o){1&n&&t._uU(0," Your device does not support Picture-in-Picture API.\n")}const b=[{path:"",component:(()=>{class n{constructor(e,c){this.cdr=e,this.platformShield=c,this.pictureInPictureEnabled=this.platformShield.pictureInPictureEnabled,this.rtcSupported="RTCPeerConnection"in this.platformShield.nativeWindow}get rtcActive(){return!!this.rtcSender}startRTC(){var e=this;return(0,m.Z)(function*(){try{const c=yield e.platformShield.mediaDevices.getUserMedia({video:!0}),i=new RTCPeerConnection,a=new RTCPeerConnection;c.getTracks().forEach(s=>{e.rtcSender=i.addTrack(s,c)}),a.addEventListener("track",s=>{e.remoteVideo.nativeElement.srcObject=s.streams[0]}),e.handleIceCandidateEvents(i,a),e.createSendingOffer(i,a),e.sendingConnection=i,e.localVideo.nativeElement.srcObject=c,e.cdr.markForCheck()}catch(c){console.error(c)}})()}stopRTC(){!this.rtcSender||!this.sendingConnection||(this.sendingConnection.removeTrack(this.rtcSender),this.sendingConnection.close(),this.sendingConnection=void 0,this.remoteVideo.nativeElement.srcObject=null,this.localVideo.nativeElement.srcObject=null,this.exitPictureInPicture(),this.rtcSender=void 0)}togglePictureInPicture(){const e=this.platformShield.nativeDocument;e.pictureInPictureElement?e.exitPictureInPicture():this.pictureInPictureEnabled&&this.localVideo.nativeElement.requestPictureInPicture()}exitPictureInPicture(){this.platformShield.nativeDocument.pictureInPictureElement&&this.platformShield.nativeDocument.exitPictureInPicture()}handleIceCandidateEvents(e,c){e.addEventListener("icecandidate",i=>{i.candidate&&c.addIceCandidate(new RTCIceCandidate(i.candidate))}),c.addEventListener("icecandidate",i=>{i.candidate&&e.addIceCandidate(new RTCIceCandidate(i.candidate))})}createSendingOffer(e,c){return(0,m.Z)(function*(){try{const i=yield e.createOffer({offerToReceiveVideo:!0});e.setLocalDescription(i),c.setRemoteDescription(i);const a=yield c.createAnswer({offerToReceiveVideo:1});e.setRemoteDescription(a),c.setLocalDescription(a)}catch(i){console.error("createOffer()/createAnswer() failed "+i)}})()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO),t.Y36(f.t))},n.\u0275cmp=t.Xpm({type:n,selectors:[["playground-rtc"]],viewQuery:function(e,c){if(1&e&&(t.Gf(h,5),t.Gf(g,5)),2&e){let i;t.iGM(i=t.CRH())&&(c.localVideo=i.first),t.iGM(i=t.CRH())&&(c.remoteVideo=i.first)}},hostAttrs:[1,"full-size","p-3","overflow-auto"],decls:5,vars:2,consts:[[4,"ngIf","ngIfElse"],["rtcUnsupported",""],["pictureInPictureUnsupported",""],[1,"d-flex","flex-wrap","gap-2","mb-3"],["type","button","color","primary","mat-raised-button","",1,"",3,"disabled","click"],["type","button","color","primary","mat-raised-button","",3,"disabled","click"],[1,"mb-3"],["autoplay","",1,"max-inline-100"],["localVideo",""],[1,"mt-2"],["type","button","mat-raised-button","",3,"disabled","click",4,"ngIf","ngIfElse"],["remoteVideo",""],["type","button","mat-raised-button","",3,"disabled","click"]],template:function(e,c){if(1&e&&(t.YNc(0,R,18,4,"ng-container",0),t.YNc(1,v,1,0,"ng-template",null,1,t.W1O),t.YNc(3,_,1,0,"ng-template",null,2,t.W1O)),2&e){const i=t.MAs(2);t.Q6J("ngIf",c.rtcSupported)("ngIfElse",i)}},dependencies:[l.O5,u.lW],styles:["video[_ngcontent-%COMP%]{border:1px solid #999;block-size:225px;inline-size:300px}"],changeDetection:0}),n})()}];let T=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.Bz.forChild(b),p.Bz]}),n})(),P=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[l.ez,u.ot,T]}),n})()}}]);
//# sourceMappingURL=70.3fd56d16f326b95d.js.map