"use strict";(self.webpackChunki18n=self.webpackChunki18n||[]).push([[70],{8070:(x,s,r)=>{r.r(s),r.d(s,{RtcModule:()=>b});var l=r(4666),u=r(4522),m=r(8835),p=r(3918),e=r(2560),f=r(7157);const h=["localVideo"],C=["remoteVideo"];function v(i,c){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"button",3),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.startRTC())}),e._uU(3,"Start RTC"),e.qZA(),e.TgZ(4,"button",4),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.stopRTC())}),e._uU(5,"Stop RTC"),e.qZA()(),e.TgZ(6,"article",5)(7,"h3"),e._uU(8,"Local video"),e.qZA(),e._UZ(9,"video",6,7),e.TgZ(11,"div",8)(12,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.togglePictureInPicture())}),e._uU(13,"Toggle Picture-in-Picture"),e.qZA()()(),e.TgZ(14,"article")(15,"h3"),e._uU(16,"Remote video"),e.qZA(),e._UZ(17,"video",6,10),e.qZA(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("disabled",t.rtcActive),e.xp6(2),e.Q6J("disabled",!t.rtcActive),e.xp6(8),e.Q6J("disabled",!t.rtcActive)}}function R(i,c){1&i&&e._uU(0," Your device does not support real-time communication in the Web.\n")}const g=[{path:"",component:(()=>{class i{constructor(t,o){this.cdr=t,this.platformShield=o,this.rtcSupported="RTCPeerConnection"in this.platformShield.nativeWindow}get rtcActive(){return!!this.rtcSender}startRTC(){var t=this;return(0,p.Z)(function*(){try{const o=yield t.platformShield.mediaDevices.getUserMedia({video:!0}),n=new RTCPeerConnection,a=new RTCPeerConnection;o.getTracks().forEach(d=>{t.rtcSender=n.addTrack(d,o)}),a.addEventListener("track",d=>{t.remoteVideo.nativeElement.srcObject=d.streams[0]}),t.handleIceCandidateEvents(n,a),t.createSendingOffer(n,a),t.sendingConnection=n,t.localVideo.nativeElement.srcObject=o,t.cdr.markForCheck()}catch(o){console.error(o)}})()}stopRTC(){!this.rtcSender||!this.sendingConnection||(this.sendingConnection.removeTrack(this.rtcSender),this.sendingConnection.close(),this.sendingConnection=void 0,this.remoteVideo.nativeElement.srcObject=null,this.localVideo.nativeElement.srcObject=null,this.exitPictureInPicture(),this.rtcSender=void 0)}togglePictureInPicture(){const t=this.platformShield.nativeDocument;t.pictureInPictureElement?t.exitPictureInPicture():this.platformShield.pictureInPictureEnabled&&this.localVideo.nativeElement.requestPictureInPicture()}exitPictureInPicture(){this.platformShield.nativeDocument.pictureInPictureElement&&this.platformShield.nativeDocument.exitPictureInPicture()}handleIceCandidateEvents(t,o){t.addEventListener("icecandidate",n=>{n.candidate&&o.addIceCandidate(new RTCIceCandidate(n.candidate))}),o.addEventListener("icecandidate",n=>{n.candidate&&t.addIceCandidate(new RTCIceCandidate(n.candidate))})}createSendingOffer(t,o){return(0,p.Z)(function*(){try{const n=yield t.createOffer({offerToReceiveVideo:!0});t.setLocalDescription(n),o.setRemoteDescription(n);const a=yield o.createAnswer({offerToReceiveVideo:1});t.setRemoteDescription(a),o.setLocalDescription(a)}catch(n){console.error("createOffer()/createAnswer() failed "+n)}})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.sBO),e.Y36(f.t))},i.\u0275cmp=e.Xpm({type:i,selectors:[["playground-rtc"]],viewQuery:function(t,o){if(1&t&&(e.Gf(h,5),e.Gf(C,5)),2&t){let n;e.iGM(n=e.CRH())&&(o.localVideo=n.first),e.iGM(n=e.CRH())&&(o.remoteVideo=n.first)}},hostAttrs:[1,"full-size","p-3","overflow-auto"],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["rtcNotSupported",""],[1,"d-flex","gap-2","mb-3"],["type","button","color","primary","mat-raised-button","",1,"",3,"disabled","click"],["type","button","color","primary","mat-raised-button","",3,"disabled","click"],[1,"mb-3"],["autoplay","",1,"max-inline-100"],["localVideo",""],[1,"d-flex","flex-wrap","gap-2","mt-2"],["type","button","mat-raised-button","",3,"disabled","click"],["remoteVideo",""]],template:function(t,o){if(1&t&&(e.YNc(0,v,19,3,"ng-container",0),e.YNc(1,R,1,0,"ng-template",null,1,e.W1O)),2&t){const n=e.MAs(2);e.Q6J("ngIf",o.rtcSupported)("ngIfElse",n)}},dependencies:[l.O5,u.lW],styles:["video[_ngcontent-%COMP%]{border:1px solid #999;block-size:225px;inline-size:300px}"],changeDetection:0}),i})()}];let T=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.Bz.forChild(g),m.Bz]}),i})(),b=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[l.ez,u.ot,T]}),i})()}}]);
//# sourceMappingURL=70.f988bb01ea1def78.js.map