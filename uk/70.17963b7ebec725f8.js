"use strict";(self.webpackChunki18n=self.webpackChunki18n||[]).push([[70],{8070:(y,s,r)=>{r.r(s),r.d(s,{RtcModule:()=>b});var l=r(4666),u=r(4522),m=r(8835),p=r(3918),e=r(2560),f=r(7157);const h=["localVideo"],C=["remoteVideo"];function R(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"button",3),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.startRTC())}),e._uU(3,"Start RTC"),e.qZA(),e.TgZ(4,"button",4),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.stopRTC())}),e._uU(5,"Stop RTC"),e.qZA()(),e.TgZ(6,"article",5)(7,"h3"),e._uU(8,"Local video"),e.qZA(),e._UZ(9,"video",6,7),e.TgZ(11,"div",8)(12,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.togglePictureInPicture())}),e._uU(13,"Toggle Picture-in-Picture"),e.qZA()()(),e.TgZ(14,"article")(15,"h3"),e._uU(16,"Remote video"),e.qZA(),e._UZ(17,"video",6,10),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("disabled",t.rtcActive),e.xp6(2),e.Q6J("disabled",!t.rtcActive),e.xp6(8),e.Q6J("disabled",!t.rtcActive)}}function g(o,i){1&o&&e._uU(0," Your device does not support real-time communication in the Web.\n")}const v=[{path:"",component:(()=>{class o{constructor(t,c){this.cdr=t,this.platformShield=c,this.rtcSupported="RTCPeerConnection"in this.platformShield.nativeWindow}get rtcActive(){return!!this.rtcSender}startRTC(){var t=this;return(0,p.Z)(function*(){try{const c=yield t.platformShield.mediaDevices.getUserMedia({video:!0}),n=new RTCPeerConnection,d=new RTCPeerConnection;c.getTracks().forEach(a=>{t.rtcSender=n.addTrack(a,c)}),d.addEventListener("track",a=>{t.remoteVideo.nativeElement.srcObject=a.streams[0]}),t.handleIceCandidateEvents(n,d),t.createSendingOffer(n,d),t.sendingConnection=n,t.localVideo.nativeElement.srcObject=c,t.cdr.markForCheck()}catch(c){console.error(c)}})()}stopRTC(){!this.rtcSender||!this.sendingConnection||(this.sendingConnection.removeTrack(this.rtcSender),this.sendingConnection.close(),this.sendingConnection=void 0,this.remoteVideo.nativeElement.srcObject=null,this.localVideo.nativeElement.srcObject=null,this.rtcSender=void 0)}togglePictureInPicture(){const t=this.platformShield.nativeDocument;t.pictureInPictureElement?t.exitPictureInPicture():this.platformShield.pictureInPictureEnabled&&this.localVideo.nativeElement.requestPictureInPicture()}handleIceCandidateEvents(t,c){t.addEventListener("icecandidate",n=>{n.candidate&&c.addIceCandidate(new RTCIceCandidate(n.candidate))}),c.addEventListener("icecandidate",n=>{n.candidate&&t.addIceCandidate(new RTCIceCandidate(n.candidate))})}createSendingOffer(t,c){return(0,p.Z)(function*(){try{const n=yield t.createOffer({offerToReceiveVideo:!0});t.setLocalDescription(n),c.setRemoteDescription(n);const d=yield c.createAnswer({offerToReceiveVideo:1});t.setRemoteDescription(d),c.setLocalDescription(d)}catch(n){console.error("createOffer()/createAnswer() failed "+n)}})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(f.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["playground-rtc"]],viewQuery:function(t,c){if(1&t&&(e.Gf(h,5),e.Gf(C,5)),2&t){let n;e.iGM(n=e.CRH())&&(c.localVideo=n.first),e.iGM(n=e.CRH())&&(c.remoteVideo=n.first)}},hostAttrs:[1,"full-size","p-3","overflow-hidden"],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["rtcNotSupported",""],[1,"d-flex","gap-2","mb-3"],["type","button","color","primary","mat-raised-button","",1,"",3,"disabled","click"],["type","button","color","primary","mat-raised-button","",3,"disabled","click"],[1,"mb-3"],["autoplay","",1,"max-inline-100"],["localVideo",""],[1,"d-flex","flex-wrap","gap-2","mt-2"],["type","button","mat-raised-button","",3,"disabled","click"],["remoteVideo",""]],template:function(t,c){if(1&t&&(e.YNc(0,R,19,3,"ng-container",0),e.YNc(1,g,1,0,"ng-template",null,1,e.W1O)),2&t){const n=e.MAs(2);e.Q6J("ngIf",c.rtcSupported)("ngIfElse",n)}},dependencies:[l.O5,u.lW],styles:["video[_ngcontent-%COMP%]{border:1px solid #999;block-size:225px;inline-size:300px}"],changeDetection:0}),o})()}];let T=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[m.Bz.forChild(v),m.Bz]}),o})(),b=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[l.ez,u.ot,T]}),o})()}}]);
//# sourceMappingURL=70.17963b7ebec725f8.js.map