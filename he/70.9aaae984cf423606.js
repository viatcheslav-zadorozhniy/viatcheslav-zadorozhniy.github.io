"use strict";(self.webpackChunki18n=self.webpackChunki18n||[]).push([[70],{8070:(R,u,r)=>{r.r(u),r.d(u,{RtcModule:()=>d});var p=r(4666),m=r(4522),f=r(2965),h=r(3918),t=r(2560),g=r(5364);const C=["localVideo"],v=["remoteVideo"];function _(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const c=t.oxw(2);return t.KtG(c.togglePictureInPicture())}),t._uU(1,"Toggle Picture-in-Picture"),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("disabled",!e.rtcActive)}}function b(o,n){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",3)(2,"button",4),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.startRTC())}),t._uU(3,"Start RTC"),t.qZA(),t.TgZ(4,"button",5),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.stopRTC())}),t._uU(5,"Stop RTC"),t.qZA()(),t.TgZ(6,"section",6)(7,"h3"),t._uU(8,"Local video"),t.qZA(),t._UZ(9,"video",7,8),t.TgZ(11,"div",9),t.YNc(12,_,2,1,"button",10),t.qZA()(),t.TgZ(13,"section")(14,"h3"),t._uU(15,"Remote video"),t.qZA(),t._UZ(16,"video",7,11),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(),i=t.MAs(4);t.xp6(2),t.Q6J("disabled",e.rtcActive),t.xp6(2),t.Q6J("disabled",!e.rtcActive),t.xp6(8),t.Q6J("ngIf",e.pictureInPictureEnabled)("ngIfElse",i)}}function T(o,n){1&o&&t._uU(0," Your device does not support real-time communication in the Web.\n")}function P(o,n){1&o&&t._uU(0," Your device does not support Picture-in-Picture API.\n")}class s{constructor(n,e){this.cdr=n,this.platformShield=e,this.pictureInPictureEnabled=this.platformShield.pictureInPictureEnabled,this.rtcSupported="RTCPeerConnection"in this.platformShield.nativeWindow}get rtcActive(){return!!this.rtcSender}startRTC(){var n=this;return(0,h.Z)(function*(){try{const e=yield n.platformShield.mediaDevices.getUserMedia({video:!0}),i=new RTCPeerConnection,c=new RTCPeerConnection;e.getTracks().forEach(l=>{n.rtcSender=i.addTrack(l,e)}),c.addEventListener("track",l=>{n.remoteVideo.nativeElement.srcObject=l.streams[0]}),n.handleIceCandidateEvents(i,c),n.createSendingOffer(i,c),n.sendingConnection=i,n.localVideo.nativeElement.srcObject=e,n.cdr.markForCheck()}catch(e){console.error(e)}})()}stopRTC(){!this.rtcSender||!this.sendingConnection||(this.sendingConnection.removeTrack(this.rtcSender),this.sendingConnection.close(),this.sendingConnection=void 0,this.remoteVideo.nativeElement.srcObject=null,this.localVideo.nativeElement.srcObject=null,this.exitPictureInPicture(),this.rtcSender=void 0)}togglePictureInPicture(){const n=this.platformShield.nativeDocument;n.pictureInPictureElement?n.exitPictureInPicture():this.pictureInPictureEnabled&&this.localVideo.nativeElement.requestPictureInPicture()}exitPictureInPicture(){this.platformShield.nativeDocument.pictureInPictureElement&&this.platformShield.nativeDocument.exitPictureInPicture()}handleIceCandidateEvents(n,e){n.addEventListener("icecandidate",i=>{i.candidate&&e.addIceCandidate(new RTCIceCandidate(i.candidate))}),e.addEventListener("icecandidate",i=>{i.candidate&&n.addIceCandidate(new RTCIceCandidate(i.candidate))})}createSendingOffer(n,e){return(0,h.Z)(function*(){try{const i=yield n.createOffer({offerToReceiveVideo:!0});n.setLocalDescription(i),e.setRemoteDescription(i);const c=yield e.createAnswer({offerToReceiveVideo:1});n.setRemoteDescription(c),e.setLocalDescription(c)}catch(i){console.error("createOffer()/createAnswer() failed "+i)}})()}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(t.sBO),t.Y36(g.tY))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["playground-rtc"]],viewQuery:function(e,i){if(1&e&&(t.Gf(C,5),t.Gf(v,5)),2&e){let c;t.iGM(c=t.CRH())&&(i.localVideo=c.first),t.iGM(c=t.CRH())&&(i.remoteVideo=c.first)}},hostAttrs:[1,"full-size","p-3","overflow-auto"],decls:5,vars:2,consts:[[4,"ngIf","ngIfElse"],["rtcUnsupported",""],["pictureInPictureUnsupported",""],[1,"d-flex","flex-wrap","gap-2","mb-3"],["type","button","color","primary","mat-raised-button","",1,"",3,"disabled","click"],["type","button","color","primary","mat-raised-button","",3,"disabled","click"],[1,"mb-3"],["autoplay","",1,"max-inline-100"],["localVideo",""],[1,"mt-2"],["type","button","mat-raised-button","",3,"disabled","click",4,"ngIf","ngIfElse"],["remoteVideo",""],["type","button","mat-raised-button","",3,"disabled","click"]],template:function(e,i){if(1&e&&(t.YNc(0,b,18,4,"ng-container",0),t.YNc(1,T,1,0,"ng-template",null,1,t.W1O),t.YNc(3,P,1,0,"ng-template",null,2,t.W1O)),2&e){const c=t.MAs(2);t.Q6J("ngIf",i.rtcSupported)("ngIfElse",c)}},dependencies:[p.O5,m.lW],styles:["video[_ngcontent-%COMP%]{border:1px solid #999;block-size:225px;inline-size:300px}"],changeDetection:0})}const I=[{path:"",component:s}];class a{static#t=this.\u0275fac=function(e){return new(e||a)};static#e=this.\u0275mod=t.oAB({type:a});static#n=this.\u0275inj=t.cJS({imports:[f.Bz.forChild(I),f.Bz]})}class d{static#t=this.\u0275fac=function(e){return new(e||d)};static#e=this.\u0275mod=t.oAB({type:d});static#n=this.\u0275inj=t.cJS({imports:[p.ez,m.ot,a]})}}}]);
//# sourceMappingURL=70.9aaae984cf423606.js.map